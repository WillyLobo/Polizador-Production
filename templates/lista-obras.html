{% extends "base.html" %}
{% block content %}

<div class="container-fluid">
    <table id="lista-obras" class="table table-striped table-bordered align-middle" style="width:100%">
      <thead>
        <tr>
          <th> Acciones </th>
          <th> Nombre </th>
          <th> Cantidad de Soluciones </th>
          <th> Empresa </th>
          <th> Localidad </th>
          <th> Grupo </th>
          <th> Plazo de Ejecución </th>
          <th> Programa </th>
          <th> Convenio/ACU </th>
          <th> Expediente </th>
          <th> Resolución </th>
          <th> Compulsa Tipo </th>
          <th> Compulsa Número</th>
          <th> Compulsa Año </th>
          <th> Nomenclatura </th>
          <th> N° Plano </th>
          <th> Fecha de Firma de Contrato </th>
          <th> Fecha de Entrega de la Obra</th>
          <th> Número de Expediente de Costos </th>
          <th> Inspectores </th>
          <th> Contrato Nacion Pesos </th>
          <th> Contrato Nacion UVI </th>
          <th> Contrato Nacion UVI Fecha</th>
          <th> Contrato Provincia Pesos </th>
          <th> Contrato Provincia UVI </th>
          <th> Contrato Provincia UVI Fecha</th>
          <th> Observaciones </th>
        </tr>
      </thead>
      <tfoot>
        <tr>
          <th> Acciones </th>
          <th> Nombre </th>
          <th> Cantidad de Soluciones </th>
          <th> Empresa </th>
          <th> Localidad </th>
          <th> Grupo </th>
          <th> Plazo de Ejecución </th>
          <th> Programa </th>
          <th> Convenio/ACU </th>
          <th> Expediente </th>
          <th> Resolución </th>
          <th> Compulsa Tipo </th>
          <th> Compulsa Número</th>
          <th> Compulsa Año </th>
          <th> Nomenclatura </th>
          <th> N° Plano </th>
          <th> Fecha de Firma de Contrato </th>
          <th> Fecha de Entrega de la Obra</th>
          <th> Número de Expediente de Costos </th>
          <th> Inspectores </th>
          <th> Contrato Nacion Pesos </th>
          <th> Contrato Nacion UVI </th>
          <th> Contrato Nacion UVI Fecha</th>
          <th> Contrato Provincia Pesos </th>
          <th> Contrato Provincia UVI </th>
          <th> Contrato Provincia UVI Fecha </th>
          <th> Observaciones </th>
        </tr>
      </tfoot>
    </table>
</div>

<script>
  $(document).ready( function() {
      'use strict';
      var TableObra
      TableObra = $('#lista-obras').DataTable({
      serverSide: true,
      processing: true,
      scrollX: true,
      order: [[0, "desc"]],
      lengthMenu: [[25, 50, 100, -1], [25, 50, 100, "All"]],
      "language": {"url": 'https://cdn.datatables.net/plug-ins/1.10.24/i18n/Spanish.json'},
      "ajax": {"url": "/api/api/obras/?format=datatables"},
      columnDefs: [{"targets": 0, "data": "id", "render": function ( data, type, row, meta ) 
		{ return '<a href="/polizas/crear/obra/'+data+'"><img src="/static/edit.png" alt="Editar" width="30" height="30" /></a><a href=" '+data+'"><img src="/static/print.png" alt="Imprimir" width="30" heigth="30" /></a>';} }],
      columns: [
        {"data":"id", searchable: false},
        {"data":"obra_nombre"},
        {"data":"obra_soluciones"},
        {"data":"obra_empresa.empresa_nombre", "name":"obra_empresa.empresa_nombre"},
        {"data":"obra_localidad.localidad_nombre", "name":"obra_localidad.localidad_nombre"},
        {"data":"obra_grupo"},
        {"data":"obra_plazo"},
        {"data":"obra_programa.programa_nombre", "name":"obra_programa.programa_nombre"},
        {"data":"obra_convenio"},
        {"data":"obra_expediente"},
        {"data":"obra_resolucion"},
        {"data":"obra_licitacion_tipo"},
        {"data":"obra_licitacion_numero"},
        {"data":"obra_licitacion_ano"},
        {"data":"obra_nomenclatura"},
        {"data":"obra_nomenclatura_plano"},
        {"data":"obra_fecha_contrato"},
        {"data":"obra_fecha_entrega"},
        {"data":"obra_expediente_costo"},
        {"data":"obra_inspector", "name":"obra_inspector"},
        {"data":"obra_contrato_nacion_pesos"},
        {"data":"obra_contrato_nacion_uvi"},
        {"data":"obra_contrato_nacion_uvi_fecha"},
        {"data":"obra_contrato_provincia_pesos"},
        {"data":"obra_contrato_provincia_uvi"},
        {"data":"obra_contrato_provincia_uvi_fecha"},
        {"data":"obra_observaciones"},
      ],
      });
      // 24
      yadcf.init(TableObra, [
          {
            column_number: 1,
            filter_type: "select",
            filter_default_label: "Filtrar",
          },
          {
            column_number: 2,
            filter_type: "select",
            filter_default_label: "Filtrar",
          },
          {
            column_number: 3,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
            column_number: 4,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
            column_number: 7,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
            column_number: 8,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
            column_number: 9,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
            column_number: 10,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
          // YADCF doesnt seem to support "get_display" objects filtering. Leaving the code for the "Compulsa Tipo"
          // column as placeholder until i find a solution for the problem.
            column_number: 11,
            filter_type: "select",
            filter_default_label: "Filtar"
          },
          {
            column_number: 12,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
            column_number: 13,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
            column_number: 16,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
            column_number: 17,
            filter_type: "select",
            filter_default_label: "Filtrar"
          },
          {
            column_number: 18,
            filter_type: "select",
            filter_default_label: "Filtrar",
          },
          {
            column_number: 19,
            filter_type: "select",
            filter_default_label: "Filtrar",
          },

          ],
          "footer",
          );
  });
</script>

{% endblock %}